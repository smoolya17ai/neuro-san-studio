# Copyright (C) 2023-2025 Cognizant Digital Business, Evolutionary AI.
# All Rights Reserved.
# Issued under the Academic Public License.
#
# You can be released from the terms, and requirements of the Academic Public
# License by purchasing a commercial license.
# Purchase of a commercial license is mandatory for any use of the
# neuro-san SDK Software in commercial settings.
#
# END COPYRIGHT

# To use this agent network, you will need to
# - pip install -U langchain-google-community\[gmail\]
# - set up your credentials explained in 
# https://developers.google.com/workspace/gmail/api/quickstart/python#authorize_credentials_for_a_desktop_application.
# Once you've downloaded the credentials.json file and put it in the top level of this repo,
# you can start using the agent network.

{
    "llm_config": {
        "model_name": "gpt-4o",
    },
    "max_execution_seconds": 6000,
    "tools": [
        {
            "name": "Agent Network Architect",
            "function": {
                description = "Designs a multi-agent network and can email the configuration HOCON file to specified recipients."
            },
            "instructions": """
You are a helpful assistant that supports users in building agent networks.

Only respond to inquiries that are directly related to your area of expertise—agent network design and configuration. Do not attempt to assist with unrelated matters. Avoid mentioning what you cannot do; focus only on what you can do.

Begin by asking for the name of a company, organization, or a description of the target domain. This context will be used to guide the network design.

Use the '/agent_network_designer' tool to generate the network configuration (typically in HOCON format).
The response from this tool will include the name of the agent network in the sentence: 
'You are part of a <agent_network_name> of assistants.'
and avoid repeating the line: 'You are part of a <agent_network_name> of assistants.' in your response.

The configuration file will be located at:  
`registries/<agent_network_name>.hocon`

When answering questions about the agent network, only use information provided in the tool response. Do not invent or infer additional details beyond what the tool has returned.

If the user asks you to test the agent network, use the 'agent_network_tester' tool.
ALWAYS include the following two things in your reply:
1. The exact test query you sent to the network.
2. The response you received from the network.

Do not summarize. Show both clearly and completely.

If the user asks you to create a graph or visualization of the agent network, use the 'agent_network_html_generator' tool.

If the user requests it, use the 'gmail_handler_with_attachment' tool to email the generated file to a specified email address.

Always ask for clarification if the user's intent is ambiguous.
""",
            "allow": {
                "to_upstream": {
                    "sly_data": {
                        "AutomaticallyDesignedAgentNetwork": true,
                    }
                }
                "from_downstream": {
                    "sly_data": {
                        "AutomaticallyDesignedAgentNetwork": true,
                    }
                }
            },
            "tools": ["/agent_network_designer", "agent_network_html_generator", "agent_network_tester", "gmail_handler_with_attachment"]
        },

        {
            "name": "agent_network_html_generator",
            "toolbox": "agent_network_html_generator"
        },

        {
            "name": "agent_network_tester",
            "function": {
                "description": "Test the agent network by sending it a test or sample query.",
                "parameters": {
                    "type": "object",
                    "properties": {
                        "agent_name": {
                            "type": string,
                            "description": "Name of the agent to test"
                        },
                        "query": {
                            "type": "string",
                            "description": "Query for the test"
                        }
                    },
                    "required": ["agent_name", "query"]
                }
            },
            "class": "nsflow_selenium.NsflowSelenium"
            "args": {
                # User-defined arguments for the tool

                # --- Required Argument ---

                # URL for connecting to nsflow
                "url": "http://localhost:4174",

                # --- Optional Arguments ---

                # Time in second for selenium to wait for each element to load or appear
                "time_to_find_element": 120.0,

                # Time in second to wait before clicking send after the text input
                "time_before_click_send": 2.0,

                # Time in second before closing the browser after the agent responses
                "time_after_response_before_close": 10.0
            }
        },

        {
            "name": "gmail_handler_with_attachment",

            # "send_gmail_message_with_attachment" is a coded tool from the toolbox located at toolbox/toolbox_info.hocon
            # This tool is solely for sending an email with attachment.
            # The code of this tool can be found at coded_tools/gmail_attachment.py
            "toolbox": "send_gmail_message_with_attachment"
            "args": {
                # Set "html" to true to send message as html.
                "html": true,
                "message": """
<html>
    <p>Hi,</p>

    <p>Thank you for connecting with Cognizant at the <strong>Newsweek AI Impact Summit in Sonoma, CA</strong>!</p>

    <p>We’re excited to share your custom-built <strong>Generative AI Multi-Agent Network</strong>, developed live at the event using our cutting-edge <em>Neuro AI</em> platform. Attached, you’ll find:</p>

    <ul>
      <li>
        An interactive <strong>HTML visualization</strong> of your agent network—just open it in any browser to explore how each agent functions by simply moving your mouse over nodes in the graph to view detailed settings.
      </li>
      <li>
        A <code>.hocon</code> configuration file containing the full technical specs of your setup.
      </li>
    </ul>

    <h3>Get Started in Minutes</h3>

    <p>To bring your network to life on your local machine:</p>

    <ol>
      <li>Download the Neuro AI Multi-Agent Accelerator from the <a href="https://github.com/cognizant-ai-lab/neuro-san-studio" target="_blank">GitHub repo</a>.</li>
      <li>Follow the README to complete installation.</li>
      <li>Drop your <code>.hocon</code> file into the <code>registries</code> folder and register it in the <code>manifest.hocon</code>.</li>
      <li>Customize your network by editing the <code>.hocon</code> file in any text editor.</li>
    </ol>

    <p><strong>Note:</strong> To activate LLM capabilities, you’ll need an API key from OpenAI, Anthropic, or Azure OpenAI. We use <strong>Ollama</strong> for local LLM orchestration.</p>

    <h3>Need Help or Want to Learn More?</h3>

    <p>We’re here to support your Gen AI journey. Reach out to us anytime for guidance, demos, or to explore deeper integration possibilities.</p>

    <p>Best regards,<br>
    <strong>The Cognizant AI Team</strong></p>
  </body>
</html>
                """
            }
        }
    ]
}
